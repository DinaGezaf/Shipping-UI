<h1 class="text-center mt-5">Add New Order</h1>

<div class="formbold-main-wrapper">
  <div class="formbold-form-wrapper">
    <form [formGroup]="orderForm" (ngSubmit)="AddOrder()">
      <div class="formbold-input-wrapp formbold-mb-3">
        <div>
          <input
            type="text"
            formControlName="name"
            name="customerName"
            id="name"
            placeholder="Customer Name"
            class="formbold-form-input"
          />

          <input
            type="text"
            formControlName="phone1"
            name="phone1"
            id="phone1"
            placeholder="Phone Number1"
            class="formbold-form-input"
          />

          <input
            type="text"
            formControlName="phone2"
            name="phone2"
            id="phone2"
            placeholder="Phone Number2"
            class="formbold-form-input"
          />
        </div>
      </div>

      <div class="formbold-input-wrapp formbold-mb-3">
        <div>
          <input
            type="text"
            formControlName="email"
            name="email"
            id="email"
            placeholder="Email"
            class="formbold-form-input"
          />

          <select
            class="formbold-form-input"
            name="government"
            id="government"
            formControlName="government"
            (change)="onGovernmentChange($event)"
          >
            <option *ngFor="let government of governments" [value]="government">
              {{ government }}
            </option>
          </select>

          <select
            class="formbold-form-input"
            name="city"
            id="city"
            formControlName="city"
            [disabled]="isCityDisabled()"
          >
            <option *ngFor="let city of cities" [value]="city">
              {{ city }}
            </option>
          </select>
        </div>
      </div>

      <div class="formbold-input-wrapp formbold-mb-3">
        <div>
          <input
            type="text"
            name="stvillage"
            id="stvillage"
            formControlName="village"
            placeholder="Street & Village"
            class="formbold-form-input"
          />

          <mat-slide-toggle
            class="ms-2"
            color="primary"
            formControlName="villageDeliverd"
            (change)="onVillageDeliveryToggle($event)"
          >
            Village Delivery
          </mat-slide-toggle>
        </div>
      </div>

      <div class="formbold-input-wrapp formbold-mb-3">
        <div>
          <select
            class="formbold-form-input"
            name="shippingType"
            id="shippingType"
            formControlName="shippingType"
          >
            <option *ngFor="let state of shippingTypes" [value]="state">
              {{ state }}
            </option>
          </select>

          <select
            class="formbold-form-input"
            name="paymentType"
            id="paymentType"
            formControlName="paymentType"
          >
            <option *ngFor="let method of paymentMethods" [value]="method">
              {{ method }}
            </option>
          </select>

          <select
            class="formbold-form-input"
            name="branch"
            id="branch"
            formControlName="branch"
          >
            <option *ngFor="let branch of branches" [value]="branch">
              {{ branch }}
            </option>
          </select>
        </div>
      </div>

      <div class="formbold-input-wrapp formbold-mb-3">
        <h1 class="mx-3 my-5">Products</h1>
        <div>
          <table class="table text-center">
            <thead class="table-light">
              <tr>
                <th class="equal-width-cell">
                  <a
                    class="btn bg-blue text-light px-5 py-2"
                    (click)="addRow()"
                  >
                    Add product
                  </a>
                </th>
                <th class="equal-width-cell">Product Name</th>
                <th class="equal-width-cell">Quantity</th>
                <th class="equal-width-cell">Price</th>
                <th class="equal-width-cell">Weight</th>
                <th class="equal-width-cell">Delete</th>
              </tr>
            </thead>
            <tbody
              formArrayName="products"
              *ngFor="let row of rows; let i = index"
            >
              <tr [formGroupName]="i">
                <td></td>
                <td>
                  <input
                    type="text"
                    formControlName="productName"
                    placeholder="Product Name"
                    class="formbold-form-input"
                  />
                </td>
                <td>
                  <input
                    type="number"
                    formControlName="quantity"
                    placeholder="Quantity"
                    class="formbold-form-input"
                    (input)="subscribeToProductChanges()"
                  />
                </td>
                <td>
                  <input
                    type="number"
                    formControlName="price"
                    placeholder="Price"
                    class="formbold-form-input"
                    (input)="subscribeToProductChanges()"
                  />
                </td>
                <td>
                  <input
                    type="number"
                    formControlName="weight"
                    placeholder="Weight"
                    class="formbold-form-input"
                    (input)="subscribeToProductChanges()"
                  />
                </td>
                <td>
                  <button class="btn text-danger" (click)="deleteRow(i)">
                    <i class="bi bi-trash3-fill"></i>
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="formbold-input-wrapp formbold-mb-3">
        <div>
          <input
            type="text"
            name="totalcost"
            id="totalcost"
            formControlName="totalcost"
            placeholder="Total Cost"
            class="formbold-form-input"
            [ngModel]="orderForm.get('totalcost')?.value"
          />

          <input
            type="text"
            name="totalweight"
            formControlName="totalweight"
            id="totalweight"
            placeholder="Total Weight"
            class="formbold-form-input"
            [ngModel]="orderForm.get('totalweight')?.value"
          />
        </div>
      </div>

      <div class="d-flex justify-content-center">
        <button class="btn text-light py-2 fw-bold bg-blue w-50" type="submit">
          Save
        </button>
      </div>
    </form>
  </div>
</div>
